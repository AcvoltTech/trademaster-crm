<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trade Master CRM - Sistema Multi-Empresa</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBnV9KDUt-Vfq8RokgLdGPC197G_d7Ks_I&libraries=places"></script>
</head>
<body>

  <!-- ==================== AUTH PAGE ==================== -->
  <div id="authPage" class="auth-container">
    <div class="auth-wrapper">
      <div class="auth-left">
        <div class="auth-logo">
          <div class="logo-icon"><i class="fas fa-tools"></i></div>
          <h1>Trade Master</h1>
          <p>CRM HVACR - Sistema Multi-Empresa</p>
        </div>
        <div class="auth-features">
          <div class="feature-item">
            <i class="fas fa-check-circle"></i>
            <span>Gestión completa de clientes y trabajos</span>
          </div>
          <div class="feature-item">
            <i class="fas fa-check-circle"></i>
            <span>Despacho de técnicos con GPS</span>
          </div>
          <div class="feature-item">
            <i class="fas fa-check-circle"></i>
            <span>Facturación y cobranza integrada</span>
          </div>
          <div class="feature-item">
            <i class="fas fa-check-circle"></i>
            <span>Seguimiento de leads con Google Maps</span>
          </div>
        </div>
      </div>
      <div class="auth-right">
        <div class="auth-tabs">
          <button class="tab-btn active" onclick="switchTab('login')">Iniciar Sesión</button>
          <button class="tab-btn" onclick="switchTab('register')">Registrar Empresa</button>
        </div>

        <!-- Login Form -->
        <div id="loginForm" class="auth-form active">
          <h2>Bienvenido</h2>
          <form onsubmit="handleLogin(event)">
            <div class="form-group">
              <label>Email</label>
              <input type="email" id="loginEmail" placeholder="Email" required>
            </div>
            <div class="form-group">
              <label>Contraseña</label>
              <input type="password" id="loginPassword" placeholder="Contraseña" required>
            </div>
            <button type="submit" class="btn-primary btn-block">Iniciar Sesión</button>
          </form>
          <p class="auth-link">¿No tienes cuenta? <a href="#" onclick="switchTab('register')">Regístrate aquí</a></p>
        </div>

        <!-- Register Form -->
        <div id="registerForm" class="auth-form">
          <h2>Registrar Empresa</h2>
          <form onsubmit="handleRegister(event)">
            <div class="form-group">
              <label>Nombre de la Empresa</label>
              <input type="text" id="regCompany" placeholder="Nombre de la empresa" required>
            </div>
            <div class="form-group">
              <label>Nombre del Administrador</label>
              <input type="text" id="regName" placeholder="Nombre completo" required>
            </div>
            <div class="form-group">
              <label>Email</label>
              <input type="email" id="regEmail" placeholder="Email" required>
            </div>
            <div class="form-group">
              <label>Teléfono</label>
              <input type="tel" id="regPhone" placeholder="Teléfono" required>
            </div>
            <div class="form-group">
              <label>Contraseña</label>
              <input type="password" id="regPassword" placeholder="Contraseña (mín. 6 caracteres)" required minlength="6">
            </div>
            <div class="form-group">
              <label>Confirmar Contraseña</label>
              <input type="password" id="regConfirm" placeholder="Confirmar contraseña" required>
            </div>
            <button type="submit" class="btn-primary btn-block">Crear Cuenta</button>
          </form>
          <p class="auth-link">¿Ya tienes cuenta? <a href="#" onclick="switchTab('login')">Inicia sesión</a></p>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== MAIN APP ==================== -->
  <div id="mainApp" class="app-container" style="display:none;">

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <i class="fas fa-tools"></i>
          <span>Trade Master</span>
        </div>
        <button class="sidebar-toggle" onclick="toggleSidebar()">
          <i class="fas fa-bars"></i>
        </button>
      </div>
      <nav class="sidebar-nav">
        <a href="#" class="nav-item active" onclick="showModule('dashboard')">
          <i class="fas fa-tachometer-alt"></i>
          <span>Dashboard</span>
        </a>
        <a href="#" class="nav-item" onclick="showModule('leads')">
          <i class="fas fa-bullseye"></i>
          <span>Leads</span>
        </a>
        <a href="#" class="nav-item" onclick="showModule('dispatch')">
          <i class="fas fa-truck"></i>
          <span>Dispatch</span>
        </a>
        <a href="#" class="nav-item" onclick="showModule('clientes')">
          <i class="fas fa-users"></i>
          <span>Clientes</span>
        </a>
        <a href="#" class="nav-item" onclick="showModule('trabajos')">
          <i class="fas fa-briefcase"></i>
          <span>Trabajos</span>
        </a>
        <a href="#" class="nav-item" onclick="showModule('tecnicos')">
          <i class="fas fa-hard-hat"></i>
          <span>Técnicos</span>
        </a>
        <a href="#" class="nav-item" onclick="showModule('facturas')">
          <i class="fas fa-file-invoice-dollar"></i>
          <span>Facturas</span>
        </a>
        <a href="#" class="nav-item" onclick="showModule('cobranza')">
          <i class="fas fa-hand-holding-usd"></i>
          <span>Cobranza</span>
        </a>
        <a href="#" class="nav-item" onclick="showModule('configuracion')">
          <i class="fas fa-cog"></i>
          <span>Configuración</span>
        </a>
      </nav>
      <div class="sidebar-footer">
        <div class="user-info">
          <i class="fas fa-user-circle"></i>
          <span id="sidebarUserName">Usuario</span>
        </div>
        <button class="btn-logout" onclick="handleLogout()">
          <i class="fas fa-sign-out-alt"></i>
          <span>Salir</span>
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Top Bar -->
      <header class="top-bar">
        <div class="top-bar-left">
          <button class="mobile-menu-btn" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
          </button>
          <h2 id="pageTitle">Dashboard</h2>
        </div>
        <div class="top-bar-right">
          <div class="company-name" id="companyName">Mi Empresa</div>
          <div class="notification-bell">
            <i class="fas fa-bell"></i>
            <span class="badge">3</span>
          </div>
          <div class="user-avatar" onclick="handleLogout()">
            <i class="fas fa-user-circle"></i>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content-area">

        <!-- ===== DASHBOARD ===== -->
        <section id="mod-dashboard" class="module active">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon bg-blue"><i class="fas fa-bullseye"></i></div>
              <div class="stat-info">
                <h3 id="statLeads">0</h3>
                <p>Leads Activos</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon bg-green"><i class="fas fa-briefcase"></i></div>
              <div class="stat-info">
                <h3 id="statTrabajos">0</h3>
                <p>Trabajos en Progreso</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon bg-orange"><i class="fas fa-file-invoice-dollar"></i></div>
              <div class="stat-info">
                <h3 id="statFacturas">$0</h3>
                <p>Facturación del Mes</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon bg-red"><i class="fas fa-exclamation-triangle"></i></div>
              <div class="stat-info">
                <h3 id="statPendientes">0</h3>
                <p>Cobros Pendientes</p>
              </div>
            </div>
          </div>
          <div class="dashboard-grid">
            <div class="card">
              <div class="card-header">
                <h3>Actividad Reciente</h3>
              </div>
              <div class="card-body" id="recentActivity">
                <div class="empty-state">
                  <i class="fas fa-clipboard-list"></i>
                  <p>No hay actividad reciente</p>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card-header">
                <h3>Trabajos de Hoy</h3>
              </div>
              <div class="card-body" id="todayJobs">
                <div class="empty-state">
                  <i class="fas fa-calendar-day"></i>
                  <p>No hay trabajos programados para hoy</p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ===== LEADS ===== -->
        <section id="mod-leads" class="module">
          <div class="module-header">
            <h3>Gestión de Leads</h3>
            <button class="btn-primary" onclick="openLeadModal()">
              <i class="fas fa-plus"></i> Nuevo Lead
            </button>
          </div>
          <div class="leads-layout">
            <div class="leads-list-container">
              <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" id="leadSearch" placeholder="Buscar leads..." oninput="filterLeads()">
              </div>
              <div class="table-responsive">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>Nombre</th>
                      <th>Teléfono</th>
                      <th>Servicio</th>
                      <th>Estado</th>
                      <th>Fecha</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody id="leadsTableBody">
                    <tr>
                      <td colspan="6" class="empty-table">No hay leads registrados</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="leads-map-container">
              <div id="leadsMap" class="map-container"></div>
            </div>
          </div>
        </section>

        <!-- ===== DISPATCH ===== -->
        <section id="mod-dispatch" class="module">
          <div class="module-header">
            <h3>Despacho de Técnicos</h3>
            <button class="btn-primary" onclick="openDispatchModal()">
              <i class="fas fa-plus"></i> Nueva Asignación
            </button>
          </div>
          <div class="dispatch-layout">
            <div id="dispatchMap" class="map-container map-large"></div>
            <div class="dispatch-list">
              <h4>Asignaciones del Día</h4>
              <div id="dispatchList" class="dispatch-items">
                <div class="empty-state">
                  <i class="fas fa-truck"></i>
                  <p>No hay asignaciones para hoy</p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ===== CLIENTES ===== -->
        <section id="mod-clientes" class="module">
          <div class="module-header">
            <h3>Clientes</h3>
            <button class="btn-primary" onclick="openClientModal()">
              <i class="fas fa-plus"></i> Nuevo Cliente
            </button>
          </div>
          <div class="search-bar">
            <i class="fas fa-search"></i>
            <input type="text" id="clientSearch" placeholder="Buscar clientes..." oninput="filterClients()">
          </div>
          <div class="table-responsive">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th>Email</th>
                  <th>Teléfono</th>
                  <th>Dirección</th>
                  <th>Trabajos</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="clientsTableBody">
                <tr>
                  <td colspan="6" class="empty-table">No hay clientes registrados</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- ===== TRABAJOS ===== -->
        <section id="mod-trabajos" class="module">
          <div class="module-header">
            <h3>Trabajos</h3>
            <button class="btn-primary" onclick="openJobModal()">
              <i class="fas fa-plus"></i> Nuevo Trabajo
            </button>
          </div>
          <div class="jobs-filters">
            <button class="filter-btn active" onclick="filterJobs('todos')">Todos</button>
            <button class="filter-btn" onclick="filterJobs('pendiente')">Pendientes</button>
            <button class="filter-btn" onclick="filterJobs('en_progreso')">En Progreso</button>
            <button class="filter-btn" onclick="filterJobs('completado')">Completados</button>
          </div>
          <div class="table-responsive">
            <table class="data-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Cliente</th>
                  <th>Servicio</th>
                  <th>Técnico</th>
                  <th>Fecha</th>
                  <th>Estado</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="jobsTableBody">
                <tr>
                  <td colspan="7" class="empty-table">No hay trabajos registrados</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- ===== TÉCNICOS ===== -->
        <section id="mod-tecnicos" class="module">
          <div class="module-header">
            <h3>Técnicos</h3>
            <button class="btn-primary" onclick="openTechModal()">
              <i class="fas fa-plus"></i> Nuevo Técnico
            </button>
          </div>
          <div class="techs-grid" id="techsGrid">
            <div class="empty-state">
              <i class="fas fa-hard-hat"></i>
              <p>No hay técnicos registrados</p>
            </div>
          </div>
        </section>

        <!-- ===== FACTURAS ===== -->
        <section id="mod-facturas" class="module">
          <div class="module-header">
            <h3>Facturas</h3>
            <button class="btn-primary" onclick="openInvoiceModal()">
              <i class="fas fa-plus"></i> Nueva Factura
            </button>
          </div>
          <div class="table-responsive">
            <table class="data-table">
              <thead>
                <tr>
                  <th>No. Factura</th>
                  <th>Cliente</th>
                  <th>Trabajo</th>
                  <th>Monto</th>
                  <th>Fecha</th>
                  <th>Estado</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="invoicesTableBody">
                <tr>
                  <td colspan="7" class="empty-table">No hay facturas registradas</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- ===== COBRANZA ===== -->
        <section id="mod-cobranza" class="module">
          <div class="module-header">
            <h3>Cobranza</h3>
          </div>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon bg-green"><i class="fas fa-check-circle"></i></div>
              <div class="stat-info">
                <h3 id="cobradoTotal">$0</h3>
                <p>Total Cobrado</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon bg-red"><i class="fas fa-clock"></i></div>
              <div class="stat-info">
                <h3 id="pendienteTotal">$0</h3>
                <p>Pendiente de Cobro</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon bg-orange"><i class="fas fa-exclamation-circle"></i></div>
              <div class="stat-info">
                <h3 id="vencidoTotal">$0</h3>
                <p>Vencido</p>
              </div>
            </div>
          </div>
          <div class="table-responsive">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Factura</th>
                  <th>Cliente</th>
                  <th>Monto</th>
                  <th>Vencimiento</th>
                  <th>Estado</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="cobranzaTableBody">
                <tr>
                  <td colspan="6" class="empty-table">No hay cobros pendientes</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- ===== CONFIGURACIÓN ===== -->
        <section id="mod-configuracion" class="module">
          <div class="module-header">
            <h3>Configuración</h3>
          </div>
          <div class="config-grid">
            <div class="card">
              <div class="card-header">
                <h3><i class="fas fa-building"></i> Datos de la Empresa</h3>
              </div>
              <div class="card-body">
                <form onsubmit="saveCompanyConfig(event)">
                  <div class="form-group">
                    <label>Nombre de la Empresa</label>
                    <input type="text" id="cfgCompanyName" placeholder="Nombre de la empresa">
                  </div>
                  <div class="form-group">
                    <label>Teléfono</label>
                    <input type="tel" id="cfgCompanyPhone" placeholder="Teléfono">
                  </div>
                  <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="cfgCompanyEmail" placeholder="Email">
                  </div>
                  <div class="form-group">
                    <label>Dirección</label>
                    <input type="text" id="cfgCompanyAddress" placeholder="Dirección">
                  </div>
                  <button type="submit" class="btn-primary">Guardar Cambios</button>
                </form>
              </div>
            </div>
            <div class="card">
              <div class="card-header">
                <h3><i class="fas fa-list"></i> Servicios</h3>
              </div>
              <div class="card-body">
                <div class="form-group">
                  <label>Agregar Servicio</label>
                  <div class="input-group">
                    <input type="text" id="newServiceName" placeholder="Nombre del servicio">
                    <button class="btn-primary" onclick="addService()">Agregar</button>
                  </div>
                </div>
                <ul class="services-list" id="servicesList"></ul>
              </div>
            </div>
          </div>
        </section>

      </div>
    </main>
  </div>

  <!-- ==================== MODALS ==================== -->

  <!-- Lead Modal -->
  <div id="leadModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h3 id="leadModalTitle">Nuevo Lead</h3>
        <button class="modal-close" onclick="closeModal('leadModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form onsubmit="saveLead(event)">
          <input type="hidden" id="leadId">
          <div class="form-row">
            <div class="form-group">
              <label>Nombre</label>
              <input type="text" id="leadName" placeholder="Nombre completo" required>
            </div>
            <div class="form-group">
              <label>Teléfono</label>
              <input type="tel" id="leadPhone" placeholder="Teléfono" required>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Email</label>
              <input type="email" id="leadEmail" placeholder="Email">
            </div>
            <div class="form-group">
              <label>Servicio Requerido</label>
              <select id="leadService" required>
                <option value="">Seleccionar...</option>
                <option value="Instalación AC">Instalación AC</option>
                <option value="Reparación AC">Reparación AC</option>
                <option value="Mantenimiento">Mantenimiento</option>
                <option value="Refrigeración">Refrigeración</option>
                <option value="Calefacción">Calefacción</option>
                <option value="Ductos">Ductos</option>
                <option value="Otro">Otro</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label>Dirección</label>
            <input type="text" id="leadAddress" placeholder="Dirección completa" required>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Fuente</label>
              <select id="leadSource">
                <option value="Google">Google</option>
                <option value="Facebook">Facebook</option>
                <option value="Referido">Referido</option>
                <option value="Sitio Web">Sitio Web</option>
                <option value="Llamada">Llamada</option>
                <option value="Otro">Otro</option>
              </select>
            </div>
            <div class="form-group">
              <label>Prioridad</label>
              <select id="leadPriority">
                <option value="normal">Normal</option>
                <option value="alta">Alta</option>
                <option value="urgente">Urgente</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label>Notas</label>
            <textarea id="leadNotes" rows="3" placeholder="Notas adicionales..."></textarea>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn-secondary" onclick="closeModal('leadModal')">Cancelar</button>
            <button type="submit" class="btn-primary">Guardar Lead</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Client Modal -->
  <div id="clientModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h3 id="clientModalTitle">Nuevo Cliente</h3>
        <button class="modal-close" onclick="closeModal('clientModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form onsubmit="saveClient(event)">
          <input type="hidden" id="clientId">
          <div class="form-row">
            <div class="form-group">
              <label>Nombre</label>
              <input type="text" id="clientName" placeholder="Nombre completo" required>
            </div>
            <div class="form-group">
              <label>Teléfono</label>
              <input type="tel" id="clientPhone" placeholder="Teléfono" required>
            </div>
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="clientEmail" placeholder="Email">
          </div>
          <div class="form-group">
            <label>Dirección</label>
            <input type="text" id="clientAddress" placeholder="Dirección completa" required>
          </div>
          <div class="form-group">
            <label>Notas</label>
            <textarea id="clientNotes" rows="3" placeholder="Notas..."></textarea>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn-secondary" onclick="closeModal('clientModal')">Cancelar</button>
            <button type="submit" class="btn-primary">Guardar Cliente</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Job Modal -->
  <div id="jobModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h3 id="jobModalTitle">Nuevo Trabajo</h3>
        <button class="modal-close" onclick="closeModal('jobModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form onsubmit="saveJob(event)">
          <input type="hidden" id="jobId">
          <div class="form-row">
            <div class="form-group">
              <label>Cliente</label>
              <select id="jobClient" required>
                <option value="">Seleccionar cliente...</option>
              </select>
            </div>
            <div class="form-group">
              <label>Técnico Asignado</label>
              <select id="jobTech" required>
                <option value="">Seleccionar técnico...</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Servicio</label>
              <select id="jobService" required>
                <option value="">Seleccionar servicio...</option>
                <option value="Instalación AC">Instalación AC</option>
                <option value="Reparación AC">Reparación AC</option>
                <option value="Mantenimiento">Mantenimiento</option>
                <option value="Refrigeración">Refrigeración</option>
                <option value="Calefacción">Calefacción</option>
                <option value="Ductos">Ductos</option>
              </select>
            </div>
            <div class="form-group">
              <label>Fecha Programada</label>
              <input type="datetime-local" id="jobDate" required>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Prioridad</label>
              <select id="jobPriority">
                <option value="normal">Normal</option>
                <option value="alta">Alta</option>
                <option value="urgente">Urgente</option>
              </select>
            </div>
            <div class="form-group">
              <label>Costo Estimado</label>
              <input type="number" id="jobCost" placeholder="0.00" step="0.01" min="0">
            </div>
          </div>
          <div class="form-group">
            <label>Descripción</label>
            <textarea id="jobDescription" rows="3" placeholder="Descripción del trabajo..."></textarea>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn-secondary" onclick="closeModal('jobModal')">Cancelar</button>
            <button type="submit" class="btn-primary">Guardar Trabajo</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Tech Modal -->
  <div id="techModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h3 id="techModalTitle">Nuevo Técnico</h3>
        <button class="modal-close" onclick="closeModal('techModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form onsubmit="saveTech(event)">
          <input type="hidden" id="techId">
          <div class="form-row">
            <div class="form-group">
              <label>Nombre</label>
              <input type="text" id="techName" placeholder="Nombre completo" required>
            </div>
            <div class="form-group">
              <label>Teléfono</label>
              <input type="tel" id="techPhone" placeholder="Teléfono" required>
            </div>
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="techEmail" placeholder="Email">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Especialidad</label>
              <select id="techSpecialty">
                <option value="HVAC">HVAC</option>
                <option value="Refrigeración">Refrigeración</option>
                <option value="Calefacción">Calefacción</option>
                <option value="Ductos">Ductos</option>
                <option value="General">General</option>
              </select>
            </div>
            <div class="form-group">
              <label>Color en Mapa</label>
              <input type="color" id="techColor" value="#2ecc71">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn-secondary" onclick="closeModal('techModal')">Cancelar</button>
            <button type="submit" class="btn-primary">Guardar Técnico</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Invoice Modal -->
  <div id="invoiceModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h3 id="invoiceModalTitle">Nueva Factura</h3>
        <button class="modal-close" onclick="closeModal('invoiceModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form onsubmit="saveInvoice(event)">
          <input type="hidden" id="invoiceId">
          <div class="form-row">
            <div class="form-group">
              <label>Cliente</label>
              <select id="invoiceClient" required>
                <option value="">Seleccionar cliente...</option>
              </select>
            </div>
            <div class="form-group">
              <label>Trabajo</label>
              <select id="invoiceJob">
                <option value="">Seleccionar trabajo...</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Monto</label>
              <input type="number" id="invoiceAmount" placeholder="0.00" step="0.01" min="0" required>
            </div>
            <div class="form-group">
              <label>Fecha de Vencimiento</label>
              <input type="date" id="invoiceDueDate" required>
            </div>
          </div>
          <div class="form-group">
            <label>Descripción</label>
            <textarea id="invoiceDescription" rows="3" placeholder="Descripción de la factura..."></textarea>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn-secondary" onclick="closeModal('invoiceModal')">Cancelar</button>
            <button type="submit" class="btn-primary">Guardar Factura</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Dispatch Modal -->
  <div id="dispatchModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h3>Nueva Asignación de Despacho</h3>
        <button class="modal-close" onclick="closeModal('dispatchModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form onsubmit="saveDispatch(event)">
          <div class="form-row">
            <div class="form-group">
              <label>Técnico</label>
              <select id="dispatchTech" required>
                <option value="">Seleccionar técnico...</option>
              </select>
            </div>
            <div class="form-group">
              <label>Trabajo</label>
              <select id="dispatchJob" required>
                <option value="">Seleccionar trabajo...</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label>Hora de Despacho</label>
            <input type="datetime-local" id="dispatchTime" required>
          </div>
          <div class="form-group">
            <label>Notas</label>
            <textarea id="dispatchNotes" rows="3" placeholder="Instrucciones para el técnico..."></textarea>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn-secondary" onclick="closeModal('dispatchModal')">Cancelar</button>
            <button type="submit" class="btn-primary">Asignar Despacho</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="toast"></div>

  <script src="script.js"></script>
</body>
</html>
